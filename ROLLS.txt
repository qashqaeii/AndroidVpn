ğŸ§  PROMPT FOR CURSOR â€” ANDROID VPN APP (V2RAY CONFIG BASED)

You are a senior Android network engineer.
Build a production-grade Android VPN client that connects to predefined VLESS/V2Ray configurations fetched from a remote server API.

This is NOT a config editor app.
Users cannot see or edit configs.
They only select a location and press Connect.

ğŸ¯ APP PURPOSE

Create a VPN connector app that:

Uses Android VpnService

Uses V2Ray/Xray mobile core (libv2ray.aar)

Fetches server configs from backend

Shows latency (ping)

Connects with one tap

No login system

No subscription logic

ğŸ§± TECH STACK

Language: Kotlin

Min SDK: 24+

Architecture: MVVM

Networking: Retrofit + OkHttp

JSON: Moshi or Gson

VPN Engine: libv2ray

Coroutines + Flow

ViewBinding or Compose UI

ğŸŒ BACKEND API
Endpoint
GET https://example.com/api/servers

Response
[
  {
    "id": 1,
    "name": "Finland Fast",
    "country": "FI",
    "flag": "ğŸ‡«ğŸ‡®",
    "config": "ENCRYPTED_STRING",
    "status": "online"
  }
]

ğŸ” CONFIG SECURITY

Server returns AES encrypted VLESS config

App must:

Decrypt config

Convert VLESS URL â†’ V2Ray JSON

Feed into V2Ray core

Configs must NEVER be visible in UI or logs.

ğŸ“± MAIN FEATURES
1ï¸âƒ£ Server List Screen

Display:

Country flag

Server name

Ping in ms

Status (Online / Slow / Offline)

Ping method:

TCP socket test to host:port parsed from config

2ï¸âƒ£ Connect Button

Flow:

User selects server
â†’ Download config
â†’ Decrypt
â†’ Build V2Ray JSON
â†’ Start VpnService
â†’ Start V2Ray core
â†’ Update UI to Connected

3ï¸âƒ£ Connection States

Implement observable states:

DISCONNECTED

CONNECTING

CONNECTED

ERROR

4ï¸âƒ£ Auto Reconnect

If connection drops â†’ retry automatically.

5ï¸âƒ£ Kill Switch (Optional toggle)

If VPN disconnects unexpectedly â†’ block internet.

âš™ VPN SERVICE LAYER

Create:

MyVpnService : VpnService()


Responsibilities:

Establish TUN interface

Route traffic to V2Ray core

Handle lifecycle

Foreground notification

ğŸ§  V2RAY CORE INTEGRATION

Load libv2ray

Start/Stop core

Provide config JSON

Capture logs (debug mode only)

ğŸ”„ CONFIG PARSING

App must support parsing:

vless://UUID@host:port?type=tcp&security=none&...


Convert into V2Ray outbound JSON format.

ğŸ”’ SECURITY HARDENING

Implement:

Certificate Pinning

Proguard/Obfuscation

Root detection

Block screenshots on main screen

No clipboard usage

ğŸ§© ARCHITECTURE LAYERS
UI Layer
â†“
ViewModel
â†“
Repository
â†“
API Service
â†“
Config Decryptor
â†“
VpnManager
â†“
V2RayCoreManager

ğŸ¨ UI REQUIREMENTS

Main Screen:

App logo

Server list

Big Connect / Disconnect button

Status text (Connected to Finland)

Ping display

Minimal, clean, modern.

ğŸ“¢ PLAY STORE COMPLIANCE

Use official VpnService permission

Foreground notification while connected

No mention of bypassing restrictions

ğŸ“¦ OUTPUT EXPECTATION

Generate:

Full project structure

All classes

VpnService implementation

V2Ray core bridge

API layer

Config parser

Working connection flow

Code must be production quality, modular, and documented.